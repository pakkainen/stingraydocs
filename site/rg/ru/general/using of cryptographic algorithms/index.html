
<!doctype html>
<html lang="ru" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../../../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-8.2.5">
    
    
      
        <title>Небезопасное использование криптографических алгоритмов - Документация</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.2d9f7617.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Inter";--md-code-font:"Roboto Mono"}</style>
      
    

<style> /* Embeded fonts start */

/* roboto-300 - latin_cyrillic-ext */
@font-face {
  font-family: 'Roboto';
  font-style: normal;
  font-weight: 300;
  src: url(' ../../../../assets/fonts/roboto-v30-latin_cyrillic-ext-300.eot' /* IE9 Compat Modes */
  src: local(''),
       url(' ../../../../assets/fonts/roboto-v30-latin_cyrillic-ext-300.eot?#iefix ' format('embedded-opentype'), /* IE6-IE8 */
       url(' ../../../../assets/fonts/roboto-v30-latin_cyrillic-ext-300.woff2 ' format('woff2'), /* Super Modern Browsers */
       url(' ../../../../assets/fonts/roboto-v30-latin_cyrillic-ext-300.woff ' format('woff'), /* Modern Browsers */
       url(' ../../../../assets/fonts/roboto-v30-latin_cyrillic-ext-300.ttf ' format('truetype'), /* Safari, Android, iOS */
       url(' ../../../../assets/fonts/roboto-v30-latin_cyrillic-ext-300.svg#Roboto ' format('svg') /* Legacy iOS */
}
/* roboto-300italic - latin_cyrillic-ext */
@font-face {
  font-family: 'Roboto';
  font-style: italic;
  font-weight: 300;
  src: url(' ../../../../assets/fonts/roboto-v30-latin_cyrillic-ext-300italic.eot' /* IE9 Compat Modes */
  src: local(''),
       url(' ../../../../assets/fonts/roboto-v30-latin_cyrillic-ext-300italic.eot?#iefix ' format('embedded-opentype'), /* IE6-IE8 */
       url(' ../../../../assets/fonts/roboto-v30-latin_cyrillic-ext-300italic.woff2 ' format('woff2'), /* Super Modern Browsers */
       url(' ../../../../assets/fonts/roboto-v30-latin_cyrillic-ext-300italic.woff ' format('woff'), /* Modern Browsers */
       url(' ../../../../assets/fonts/roboto-v30-latin_cyrillic-ext-300italic.ttf ' format('truetype'), /* Safari, Android, iOS */
       url(' ../../../../assets/fonts/roboto-v30-latin_cyrillic-ext-300italic.svg#Roboto ' format('svg') /* Legacy iOS */
}
/* roboto-italic - latin_cyrillic-ext */
@font-face {
  font-family: 'Roboto';
  font-style: italic;
  font-weight: 400;
  src: url(' ../../../../assets/fonts/roboto-v30-latin_cyrillic-ext-italic.eot' /* IE9 Compat Modes */
  src: local(''),
       url(' ../../../../assets/fonts/roboto-v30-latin_cyrillic-ext-italic.eot?#iefix ' format('embedded-opentype'), /* IE6-IE8 */
       url(' ../../../../assets/fonts/roboto-v30-latin_cyrillic-ext-italic.woff2 ' format('woff2'), /* Super Modern Browsers */
       url(' ../../../../assets/fonts/roboto-v30-latin_cyrillic-ext-italic.woff ' format('woff'), /* Modern Browsers */
       url(' ../../../../assets/fonts/roboto-v30-latin_cyrillic-ext-italic.ttf ' format('truetype'), /* Safari, Android, iOS */
       url(' ../../../../assets/fonts/roboto-v30-latin_cyrillic-ext-italic.svg#Roboto ' format('svg') /* Legacy iOS */
}
/* roboto-regular - latin_cyrillic-ext */
@font-face {
  font-family: 'Roboto';
  font-style: normal;
  font-weight: 400;
  src: url(' ../../../../assets/fonts/roboto-v30-latin_cyrillic-ext-regular.eot' /* IE9 Compat Modes */
  src: local(''),
       url(' ../../../../assets/fonts/roboto-v30-latin_cyrillic-ext-regular.eot?#iefix ' format('embedded-opentype'), /* IE6-IE8 */
       url(' ../../../../assets/fonts/roboto-v30-latin_cyrillic-ext-regular.woff2 ' format('woff2'), /* Super Modern Browsers */
       url(' ../../../../assets/fonts/roboto-v30-latin_cyrillic-ext-regular.woff ' format('woff'), /* Modern Browsers */
       url(' ../../../../assets/fonts/roboto-v30-latin_cyrillic-ext-regular.ttf ' format('truetype'), /* Safari, Android, iOS */
       url(' ../../../../assets/fonts/roboto-v30-latin_cyrillic-ext-regular.svg#Roboto ' format('svg') /* Legacy iOS */
}
/* roboto-500 - latin_cyrillic-ext */
@font-face {
  font-family: 'Roboto';
  font-style: normal;
  font-weight: 500;
  src: url(' ../../../../assets/fonts/roboto-v30-latin_cyrillic-ext-500.eot' /* IE9 Compat Modes */
  src: local(''),
       url(' ../../../../assets/fonts/roboto-v30-latin_cyrillic-ext-500.eot?#iefix ' format('embedded-opentype'), /* IE6-IE8 */
       url(' ../../../../assets/fonts/roboto-v30-latin_cyrillic-ext-500.woff2 ' format('woff2'), /* Super Modern Browsers */
       url(' ../../../../assets/fonts/roboto-v30-latin_cyrillic-ext-500.woff ' format('woff'), /* Modern Browsers */
       url(' ../../../../assets/fonts/roboto-v30-latin_cyrillic-ext-500.ttf ' format('truetype'), /* Safari, Android, iOS */
       url(' ../../../../assets/fonts/roboto-v30-latin_cyrillic-ext-500.svg#Roboto ' format('svg') /* Legacy iOS */
}
/* roboto-500italic - latin_cyrillic-ext */
@font-face {
  font-family: 'Roboto';
  font-style: italic;
  font-weight: 500;
  src: url(' ../../../../assets/fonts/roboto-v30-latin_cyrillic-ext-500italic.eot' /* IE9 Compat Modes */
  src: local(''),
       url(' ../../../../assets/fonts/roboto-v30-latin_cyrillic-ext-500italic.eot?#iefix ' format('embedded-opentype'), /* IE6-IE8 */
       url(' ../../../../assets/fonts/roboto-v30-latin_cyrillic-ext-500italic.woff2 ' format('woff2'), /* Super Modern Browsers */
       url(' ../../../../assets/fonts/roboto-v30-latin_cyrillic-ext-500italic.woff ' format('woff'), /* Modern Browsers */
       url(' ../../../../assets/fonts/roboto-v30-latin_cyrillic-ext-500italic.ttf ' format('truetype'), /* Safari, Android, iOS */
       url(' ../../../../assets/fonts/roboto-v30-latin_cyrillic-ext-500italic.svg#Roboto ' format('svg') /* Legacy iOS */
}
/* roboto-700 - latin_cyrillic-ext */
@font-face {
  font-family: 'Roboto';
  font-style: normal;
  font-weight: 700;
  src: url(' ../../../../assets/fonts/roboto-v30-latin_cyrillic-ext-700.eot' /* IE9 Compat Modes */
  src: local(''),
       url(' ../../../../assets/fonts/roboto-v30-latin_cyrillic-ext-700.eot?#iefix ' format('embedded-opentype'), /* IE6-IE8 */
       url(' ../../../../assets/fonts/roboto-v30-latin_cyrillic-ext-700.woff2 ' format('woff2'), /* Super Modern Browsers */
       url(' ../../../../assets/fonts/roboto-v30-latin_cyrillic-ext-700.woff ' format('woff'), /* Modern Browsers */
       url(' ../../../../assets/fonts/roboto-v30-latin_cyrillic-ext-700.ttf ' format('truetype'), /* Safari, Android, iOS */
       url(' ../../../../assets/fonts/roboto-v30-latin_cyrillic-ext-700.svg#Roboto ' format('svg') /* Legacy iOS */
}
/* roboto-700italic - latin_cyrillic-ext */
@font-face {
  font-family: 'Roboto';
  font-style: italic;
  font-weight: 700;
  src: url(' ../../../../assets/fonts/roboto-v30-latin_cyrillic-ext-700italic.eot' /* IE9 Compat Modes */
  src: local(''),
       url(' ../../../../assets/fonts/roboto-v30-latin_cyrillic-ext-700italic.eot?#iefix ' format('embedded-opentype'), /* IE6-IE8 */
       url(' ../../../../assets/fonts/roboto-v30-latin_cyrillic-ext-700italic.woff2 ' format('woff2'), /* Super Modern Browsers */
       url(' ../../../../assets/fonts/roboto-v30-latin_cyrillic-ext-700italic.woff ' format('woff'), /* Modern Browsers */
       url(' ../../../../assets/fonts/roboto-v30-latin_cyrillic-ext-700italic.ttf ' format('truetype'), /* Safari, Android, iOS */
       url(' ../../../../assets/fonts/roboto-v30-latin_cyrillic-ext-700italic.svg#Roboto ' format('svg') /* Legacy iOS */
}

/* roboto-mono-regular - latin_cyrillic-ext */
@font-face {
  font-family: 'Roboto Mono';
  font-style: normal;
  font-weight: 400;
  src: url(' ../../../../assets/fonts/roboto-mono-v21-latin_cyrillic-ext-regular.eot' /* IE9 Compat Modes */
  src: local(''),
       url(' ../../../../assets/fonts/roboto-mono-v21-latin_cyrillic-ext-regular.eot?#iefix ' format('embedded-opentype'), /* IE6-IE8 */
       url(' ../../../../assets/fonts/roboto-mono-v21-latin_cyrillic-ext-regular.woff2 ' format('woff2'), /* Super Modern Browsers */
       url(' ../../../../assets/fonts/roboto-mono-v21-latin_cyrillic-ext-regular.woff ' format('woff'), /* Modern Browsers */
       url(' ../../../../assets/fonts/roboto-mono-v21-latin_cyrillic-ext-regular.ttf ' format('truetype'), /* Safari, Android, iOS */
       url(' ../../../../assets/fonts/roboto-mono-v21-latin_cyrillic-ext-regular.svg#RobotoMono ' format('svg') /* Legacy iOS */
}
/* roboto-mono-700 - latin_cyrillic-ext */
@font-face {
  font-family: 'Roboto Mono';
  font-style: normal;
  font-weight: 700;
  src: url(' ../../../../assets/fonts/roboto-mono-v21-latin_cyrillic-ext-700.eot' /* IE9 Compat Modes */
  src: local(''),
       url(' ../../../../assets/fonts/roboto-mono-v21-latin_cyrillic-ext-700.eot?#iefix ' format('embedded-opentype'), /* IE6-IE8 */
       url(' ../../../../assets/fonts/roboto-mono-v21-latin_cyrillic-ext-700.woff2 ' format('woff2'), /* Super Modern Browsers */
       url(' ../../../../assets/fonts/roboto-mono-v21-latin_cyrillic-ext-700.woff ' format('woff'), /* Modern Browsers */
       url(' ../../../../assets/fonts/roboto-mono-v21-latin_cyrillic-ext-700.ttf ' format('truetype'), /* Safari, Android, iOS */
       url(' ../../../../assets/fonts/roboto-mono-v21-latin_cyrillic-ext-700.svg#RobotoMono ' format('svg') /* Legacy iOS */
}
/* roboto-mono-italic - latin_cyrillic-ext */
@font-face {
  font-family: 'Roboto Mono';
  font-style: italic;
  font-weight: 400;
  src: url(' ../../../../assets/fonts/roboto-mono-v21-latin_cyrillic-ext-italic.eot' /* IE9 Compat Modes */
  src: local(''),
       url(' ../../../../assets/fonts/roboto-mono-v21-latin_cyrillic-ext-italic.eot?#iefix ' format('embedded-opentype'), /* IE6-IE8 */
       url(' ../../../../assets/fonts/roboto-mono-v21-latin_cyrillic-ext-italic.woff2 ' format('woff2'), /* Super Modern Browsers */
       url(' ../../../../assets/fonts/roboto-mono-v21-latin_cyrillic-ext-italic.woff ' format('woff'), /* Modern Browsers */
       url(' ../../../../assets/fonts/roboto-mono-v21-latin_cyrillic-ext-italic.ttf ' format('truetype'), /* Safari, Android, iOS */
       url(' ../../../../assets/fonts/roboto-mono-v21-latin_cyrillic-ext-italic.svg#RobotoMono ' format('svg') /* Legacy iOS */
}
/* roboto-mono-700italic - latin_cyrillic-ext */
@font-face {
  font-family: 'Roboto Mono';
  font-style: italic;
  font-weight: 700;
  src: url(' ../../../../assets/fonts/roboto-mono-v21-latin_cyrillic-ext-700italic.eot' /* IE9 Compat Modes */
  src: local(''),
       url(' ../../../../assets/fonts/roboto-mono-v21-latin_cyrillic-ext-700italic.eot?#iefix ' format('embedded-opentype'), /* IE6-IE8 */
       url(' ../../../../assets/fonts/roboto-mono-v21-latin_cyrillic-ext-700italic.woff2 ' format('woff2'), /* Super Modern Browsers */
       url(' ../../../../assets/fonts/roboto-mono-v21-latin_cyrillic-ext-700italic.woff ' format('woff'), /* Modern Browsers */
       url(' ../../../../assets/fonts/roboto-mono-v21-latin_cyrillic-ext-700italic.ttf ' format('truetype'), /* Safari, Android, iOS */
       url(' ../../../../assets/fonts/roboto-mono-v21-latin_cyrillic-ext-700italic.svg#RobotoMono ' format('svg') /* Legacy iOS */
}
</style>
    
      <link rel="stylesheet" href="../../../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.2/styles/default.min.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="stingray" data-md-color-primary="" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          Перейти к содержанию
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-component="outdated" hidden>
        <aside class="md-banner md-banner--warning">
          
            <div class="md-banner__inner md-grid md-typeset">
            
            Для просмотра документации на самую актуальную версию системы нажмите 
              <a href="../../../../..">
                <strong>здесь</strong>
              </a>
            .
            
            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),outdated=__md_get("__outdated",sessionStorage);!0===outdated&&el&&(el.hidden=!1)</script>
          
        </aside>
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Верхний колонтитул">
    <a href="../../../.." title="Документация" class="md-header__button md-logo" aria-label="Документация" data-md-component="logo">
      
  <img src="../../../../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Документация
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
            Документация&nbsp;&nbsp;/&nbsp;&nbsp;Небезопасное использование криптографических алгоритмов
            
          </span>
        </div>
      </div>
    </div>
    <div class="extlink"><a href="https://stingray-mobile.ru/" title="Перейти на stingray-mobile.ru" target="_self">stingray-mobile.ru</a></div>
<!--    <div class="extlink">&nbsp;&nbsp;&nbsp;</div>
    <div class="extlink">Ссылка на сайт</div>-->
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="stingray" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Поиск" placeholder="Поиск" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Поиск">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Очистить" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Инициализация поиска
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/sf-docs/stingraydocs" title="Перейти к репозиторию" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    sf-docs/stingraydocs
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Вкладки" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../../gi/" class="md-tabs__link">
        Общая информация
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../../ug/" class="md-tabs__link">
        Руководство пользователя
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../../ag/" class="md-tabs__link">
        Руководство по установке и интеграции
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../" class="md-tabs__link md-tabs__link--active">
        Рекомендации по безопасной разработке
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../../faq/" class="md-tabs__link">
      FAQ
    </a>
  </li>

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Навигация" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="Документация" class="md-nav__button md-logo" aria-label="Документация" data-md-component="logo">
      
  <img src="../../../../assets/logo.png" alt="logo">

    </a>
    Документация
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/sf-docs/stingraydocs" title="Перейти к репозиторию" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    sf-docs/stingraydocs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" data-md-state="indeterminate" type="checkbox" id="__nav_1" checked>
      
      
      
        
          
            
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../../gi/">Общая информация</a>
          
            <label for="__nav_1">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Общая информация" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Общая информация
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../gi/o_produkte/" class="md-nav__link">
        О продукте
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../gi/trebovaniya_k_rabochemu_mestu_polzovatelya/" class="md-nav__link">
        Требования к рабочему месту пользователя
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../gi/osnovnye_ponyatiya/" class="md-nav__link">
        Основные понятия
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" data-md-state="indeterminate" type="checkbox" id="__nav_2" checked>
      
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../../ug/">Руководство пользователя</a>
          
            <label for="__nav_2">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Руководство пользователя" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Руководство пользователя
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ug/autentifikaciya_polzovatelya/" class="md-nav__link">
        Аутентификация пользователя
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ug/osnovnoe_menu/" class="md-nav__link">
        Основное меню
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ug/projects/" class="md-nav__link">
        Проекты
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ug/pravila/" class="md-nav__link">
        Правила
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ug/profile/" class="md-nav__link">
        Профили
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ug/rezultaty_skanirovanij/" class="md-nav__link">
        Результаты сканирований
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ug/zapusk_skanirovaniya/" class="md-nav__link">
        Запуск сканирования
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ug/testcases/" class="md-nav__link">
        Тест-кейсы
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ug/standarty/" class="md-nav__link">
        Стандарты
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ug/profil_polzovatelya/" class="md-nav__link">
        Профиль пользователя
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ag/companies/" class="md-nav__link">
        Компании
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_13" data-md-state="indeterminate" type="checkbox" id="__nav_2_13" checked>
      
      
      
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2_13">
          Настройки
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Настройки" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_13">
          <span class="md-nav__icon md-icon"></span>
          Настройки
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ag/nastrojki/" class="md-nav__link">
        Настройки Компании
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ag/polzovateli/" class="md-nav__link">
        Пользователи, группы, проекты
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ag/pravila_analiza_na_urovne_organizacii/" class="md-nav__link">
        Правила анализа на уровне Компании
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ag/ustrojstva/" class="md-nav__link">
        Устройства
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ag/integracii/" class="md-nav__link">
        Интеграции
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ug/dokumentaciya_i_rekomendacii/" class="md-nav__link">
        Документация и рекомендации
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_15" data-md-state="indeterminate" type="checkbox" id="__nav_2_15" checked>
      
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2_15">
          Приложения
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Приложения" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_15">
          <span class="md-nav__icon md-icon"></span>
          Приложения
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ag/prilozhenie_1/" class="md-nav__link">
        <span style='color: black; background: lightgreen'>Приложение 1. Описание модулей для сбора информации
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ag/prilozhenie_2/" class="md-nav__link">
        Приложение 2. Список обнаруживаемых уязвимостей
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ag/prilozhenie_3/" class="md-nav__link">
        Приложение 3. Описание стандартов безопасности
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" data-md-state="indeterminate" type="checkbox" id="__nav_3" checked>
      
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../../ag/">Руководство по установке и интеграции</a>
          
            <label for="__nav_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Руководство по установке и интеграции" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Руководство по установке и интеграции
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ag/trebovaniya_k_infrastrukture/" class="md-nav__link">
        Требования к инфраструктуре
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ag/ustanovka_stingray/" class="md-nav__link">
        Установка Stingray
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ag/zapusk_stingray/" class="md-nav__link">
        Запуск Stingray
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ag/ostanovka_stingray/" class="md-nav__link">
        Остановка Stingray
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ag/obnovlenie_sistemy/" class="md-nav__link">
        Обновление системы
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ag/perezagruzka_servera_bez_obnovleniya_stingray/" class="md-nav__link">
        Перезагрузка сервера без обновления Stingray
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_8" data-md-state="indeterminate" type="checkbox" id="__nav_3_8" checked>
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_8">
          Интеграции системы
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Интеграции системы" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_8">
          <span class="md-nav__icon md-icon"></span>
          Интеграции системы
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ag/integracii_cherez_rest_api/" class="md-nav__link">
        Интеграции через REST API
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ag/sistemy_ci_cd/" class="md-nav__link">
        Системы CI/CD
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ag/sistema_distribucii_appcenter/" class="md-nav__link">
        Система дистрибьюции AppCenter
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ag/sistema_distribucii_nexus_repository/" class="md-nav__link">
        Система дистрибьюции Nexus Repository
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ag/integraciya_s_firebase/" class="md-nav__link">
        Интеграция с Firebase
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ag/integraciya_s_appstore/" class="md-nav__link">
        Интеграция с AppStore
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ag/integraciya_c_burp_suite/" class="md-nav__link">
        Интеграция c Burp Suite
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ag/integraciya_s_netsparker/" class="md-nav__link">
        Интеграция с Netsparker
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ag/integraciya_s_appscreener/" class="md-nav__link">
        Интеграция с AppScreener
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ag/integraciya_s_oversecured/" class="md-nav__link">
        Интеграция с Oversecured
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ag/integraciya_s_google_play/" class="md-nav__link">
        Интеграция с Google Play
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ag/integraciya_s_rustore/" class="md-nav__link">
        Интеграция с RuStore
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ag/integraciya_s_defectdojo/" class="md-nav__link">
        Интеграция с DefectDojo
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_9" data-md-state="indeterminate" type="checkbox" id="__nav_3_9" checked>
      
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_9">
          Настройка мониторинга
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Настройка мониторинга" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_9">
          <span class="md-nav__icon md-icon"></span>
          Настройка мониторинга
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ag/nastrojka_zhurnalov_audita/" class="md-nav__link">
        Настройка журналов аудита
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      
      
        
          
            
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../">Рекомендации по безопасной разработке</a>
          
            <label for="__nav_4">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Рекомендации по безопасной разработке" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Рекомендации по безопасной разработке
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2" type="checkbox" id="__nav_4_2" checked>
      
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_2">
          Общие рекомендации
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Общие рекомендации" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          Общие рекомендации
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Небезопасное использование криптографических алгоритмов
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Небезопасное использование криптографических алгоритмов
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Содержание раздела">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Содержание раздела
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    Общие понятия
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    Слабый или устаревший алгоритм шифрования
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    Простой вектор инициализации
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    Слабый ключ шифрования
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    Неверные параметры для алгоритма генерации ключа
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    Использован уязвимый алгоритм хеширования
  </a>
  
    <nav class="md-nav" aria-label="Использован уязвимый алгоритм хеширования">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    Использование слова в качестве соли
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    Использование соли с низкой энтропией
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    Ссылки
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3" data-md-state="indeterminate" type="checkbox" id="__nav_4_3" checked>
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_3">
          Рекомендации для Android
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Рекомендации для Android" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_3">
          <span class="md-nav__icon md-icon"></span>
          Рекомендации для Android
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_1" data-md-state="indeterminate" type="checkbox" id="__nav_4_3_1" checked>
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_3_1">
          Небезопасное хранение ключевой информации
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Небезопасное хранение ключевой информации" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_3_1">
          <span class="md-nav__icon md-icon"></span>
          Небезопасное хранение ключевой информации
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/a_writable_keystore/" class="md-nav__link">
        Доступное на запись хранилище ключей
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/a_keystore_with_write_permission_protected_by_a_weak_password/" class="md-nav__link">
        Доступное на запись хранилище ключей со слабым паролем
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/readable_file_keystore/" class="md-nav__link">
        Доступное на чтение файловое хранилище ключей
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/a_readable_keystore%2C_protected_by_a_weak_password%2C_with_private_keys/" class="md-nav__link">
        Доступное на чтение хранилище ключей со слабым паролем, содержащее закрытые ключи
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/a_readable_keystore%2C_protected_by_a_weak_password%2C_with_public_keys/" class="md-nav__link">
        Доступное на чтение хранилище ключей со слабым паролем, содержащее открытые ключи
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/a_readable_keystore_containing_private_keys_protected_by_a_weak_password/" class="md-nav__link">
        Доступное на чтение хранилище ключей с приватными ключами, защищёнными слабым паролем
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/using_a_file_keystore/" class="md-nav__link">
        Использование файлового хранилища ключей
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/a_keystore%2C_protected_by_weak_password%2C_containing_private_keys/" class="md-nav__link">
        Хранилище ключей со слабым паролем, содержащее закрытые ключи
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/a_keystore%2C_protected_by_weak_password%2C_containing_public_keys/" class="md-nav__link">
        Хранилище ключей со слабым паролем, содержащее открытые ключи
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/a_keystore_containing_private_keys_protected_by_a_weak_password/" class="md-nav__link">
        Хранилище ключей с приватными ключами, защищёнными слабым паролем
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_2" data-md-state="indeterminate" type="checkbox" id="__nav_4_3_2" checked>
      
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_3_2">
          Передача sensitive-информации в Activity
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Передача sensitive-информации в Activity" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_3_2">
          <span class="md-nav__icon md-icon"></span>
          Передача sensitive-информации в Activity
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/insecure_transmission_of_sensitive_information_in_activity/" class="md-nav__link">
        Небезопасная передача sensitive-информации в Activity
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/insecure_transmission_of_sensitive_information_in_external_activity/" class="md-nav__link">
        Небезопасная передача sensitive-информации во внешнюю Activity
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/insecure_transmission_of_sensitive_information_in_private_activity/" class="md-nav__link">
        Передача sensitive-информации во внутреннюю Activity
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_3" data-md-state="indeterminate" type="checkbox" id="__nav_4_3_3" checked>
      
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_3_3">
          Передача sensitive-информации в Service
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Передача sensitive-информации в Service" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_3_3">
          <span class="md-nav__icon md-icon"></span>
          Передача sensitive-информации в Service
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/insecure_transmission_of_sensitive_information_in_service/" class="md-nav__link">
        Небезопасная передача sensitive-информации в Service
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/insecure_transmission_of_sensitive_information_in_external_service/" class="md-nav__link">
        Небезопасная передача sensitive-информации во внешний Service
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/insecure_transmission_of_sensitive_information_in_internal_service/" class="md-nav__link">
        Небезопасная передача sensitive-информации во внутренний Service
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_4" data-md-state="indeterminate" type="checkbox" id="__nav_4_3_4" checked>
      
      
      
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_3_4">
          Передача sensitive-информации по сети
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Передача sensitive-информации по сети" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_3_4">
          <span class="md-nav__icon md-icon"></span>
          Передача sensitive-информации по сети
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/inclusion_of_sensitive_information_into_the_get_request_parameters/" class="md-nav__link">
        Включение sensitive-информации в параметры GET-запроса
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/inclusion_of_sensitive_information_into_an_https_request/" class="md-nav__link">
        Включение чувствительной информации в HTTPS запрос
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/transmission_of_sensitive_information_in_an_http_request/" class="md-nav__link">
        Передача sensitive информации в HTTP-запросе
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/transmission_of_sensitive_information_in_an_http_response/" class="md-nav__link">
        Получение sensitive-информации в HTTP-ответе
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/inclusion_of_sensitive_information_into_an_https_response/" class="md-nav__link">
        Получение чувствительной информации в HTTPS-ответе
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_5" data-md-state="indeterminate" type="checkbox" id="__nav_4_3_5" checked>
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_3_5">
          Хранение sensitive-информации
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Хранение sensitive-информации" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_3_5">
          <span class="md-nav__icon md-icon"></span>
          Хранение sensitive-информации
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/storing_sensitive_information_in_memory/" class="md-nav__link">
        Хранение sensitive-информации в памяти
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/storing_sensitive_information_in_a_public_file_outside_the_application_s_directory/" class="md-nav__link">
        Хранение sensitive-информации в общедоступном файле вне директории приложения
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/storing_sensitive_information_in_a_public_file_inside_the_application_s_directory/" class="md-nav__link">
        Хранение sensitive-информации в общедоступном файле внутри директории приложения
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/storing_sensitive_information_in_a_private_file_outside_the_application_s_directory/" class="md-nav__link">
        Хранение sensitive-информации в приватном файле вне директории приложения
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/storing_sensitive_information_in_a_private_file_inside_the_application_s_directory/" class="md-nav__link">
        Хранение sensitive-информации в приватном файле внутри директории приложения
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/storing_sensitive_information_in_a_public_protected_database/" class="md-nav__link">
        Хранение sensitive-информации в общедоступной защищённой базе данных
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/storing_sensitive_information_in_a_protected_database/" class="md-nav__link">
        Хранение sensitive-информации в защищённой базе данных
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/storing_sensitive_information_in_an_insecure_database/" class="md-nav__link">
        Хранение чувствительной информации в незащищённой базе данных
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/storing_sensitive_information_in_a_public_unprotected_database/" class="md-nav__link">
        Хранение sensitive-информации в общедоступной незащищённой базе данных
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/storing_sensitive_information_in_the_application_source_code/" class="md-nav__link">
        Хранение sensitive-информации в исходном коде приложения
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/storage_or_use_of_previously_found_sensitive_information/" class="md-nav__link">
        Хранение или использование ранее найденной sensitive-информации
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/storing_sensitive_information_in_the_keyboard_cache/" class="md-nav__link">
        Хранение sensitive-информации в кэше клавиатуры
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_6" data-md-state="indeterminate" type="checkbox" id="__nav_4_3_6" checked>
      
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_3_6">
          Хранение ключей/сертификатов
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Хранение ключей/сертификатов" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_3_6">
          <span class="md-nav__icon md-icon"></span>
          Хранение ключей/сертификатов
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/storing_a_private_key_certificate_that_is_not_protected_by_a_password_in_the_directory_resources_of_the_application/" class="md-nav__link">
        Хранение приватного ключа/сертификата, не защищенного паролем в директории/ресурсах приложения
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/storing_a_public_key_certificate_in_the_directory_resources_of_the_application/" class="md-nav__link">
        Хранение публичного ключа/сертификата в директории/ресурсах приложения
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/storing_a_private_key_certificate_protected_by_a_password_in_the_directory_resources_of_the_application/" class="md-nav__link">
        Хранение приватного ключа/сертификата, защищенного паролем, в директории/ресурсах приложения
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/storing_a_key_certificate_in_the_directory_resources_of_the_application/" class="md-nav__link">
        Хранение сертификата/ключа в директории/ресурсах приложения
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/output_of_sensitive_information_into_the_system_log/" class="md-nav__link">
        Вывод sensitive-информации в системный лог
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/insecure_signature_algorithm/" class="md-nav__link">
        Небезопасный алгоритм подписи
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/insufficient_length_of_a_signature_key/" class="md-nav__link">
        Недостаточная длина ключа подписи
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/transmission_of_sensitive_information_in_broadcastreceiver/" class="md-nav__link">
        Передача sensitive-информации в BroadcastReceiver
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/transmission_of_sensitive_information_to_a_private_broadcastreceiver/" class="md-nav__link">
        Передача sensitive-информации в Private BroadcastReceiver
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/transmission_of_sensitive_information_in_sql_query_parameters/" class="md-nav__link">
        Передача sensitive-информации в параметрах SQL-запроса
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/possibility_to_create_a_backup_copy_of_the_application/" class="md-nav__link">
        Возможность создания резервной копии приложения
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/application_is_not_obfuscated/" class="md-nav__link">
        Приложение не обфусцировано
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/weak_database_encryption_password/" class="md-nav__link">
        Слабый пароль шифрования базы данных
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/interception_of_the_database_encryption_password/" class="md-nav__link">
        Перехват пароля шифрования базы данных
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/an_application_allows_network_connections_via_http/" class="md-nav__link">
        Приложение разрешает сетевые соединения по протоколу HTTP
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/insecure_networking_configuration/" class="md-nav__link">
        Небезопасная конфигурация сетевого взаимодействия
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/potential_execution_of_arbitrary_code_within_the_application/" class="md-nav__link">
        Потенциальное выполнение произвольного кода в контексте приложения
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/storing_cookie_values_in_the_standard_webview_database/" class="md-nav__link">
        Хранение значений Cookies в стандартной базе WebView
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/insecure_settings_in_androidmanifest.xml/" class="md-nav__link">
        Небезопасные настройки в AndroidManifest.xml
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/insecure_settings_in_androidmanifest.xml._the_android_hasfragileuserdata_flag/" class="md-nav__link">
        Небезопасные настройки в AndroidManifest.xml. Флаг android:hasFragileUserData
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/insecure_settings_in_androidmanifest.xml._the_android_requestlegacyexternalstorage_flag/" class="md-nav__link">
        Небезопасные настройки в AndroidManifest.xml. Флаг android:requestLegacyExternalStorage
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/ssl-pinning_is_missing_or_incorrectly_realized/" class="md-nav__link">
        Отсутствует или некорректно реализован SSL-pinning
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/ability_to_run_private_activity_indirectly/" class="md-nav__link">
        Возможность опосредованного запуска приватных Activity
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/url_spoofing_possibility/" class="md-nav__link">
        Возможность подмены URL
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/ability_to_open_an_arbitrary_url_in_webview/" class="md-nav__link">
        Возможность открытия произвольного URL в WebView
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/access_to_an_arbitrary_file/" class="md-nav__link">
        Возможность получения доступа к произвольному файлу
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/access_to_an_arbitrary_contentprovider/" class="md-nav__link">
        Возможность получения доступа к произвольному ContentProvider
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/ability_to_access_an_arbitrary_file_via_contentprovider/" class="md-nav__link">
        Возможность доступа к произвольному файлу через ContentProvider
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/absence_of_root_access_check/" class="md-nav__link">
        Отсутствие проверки на root-доступ
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/absense_of_emulator_start-up_check/" class="md-nav__link">
        Отсутствие проверки на запуск на эмуляторе
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/absence_of_app_integrity_check/" class="md-nav__link">
        Отсутствие проверки целостности приложения
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/insufficient_emulator_start-up_check/" class="md-nav__link">
        Недостаточная проверка на запуск на эмуляторе
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/insufficient_root_access_check/" class="md-nav__link">
        Недостаточная проверка на root-доступ
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../android/overwrite_files_when_using_public_archives/" class="md-nav__link">
        Перезапись файлов при использовании публичных архивов
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_4" data-md-state="indeterminate" type="checkbox" id="__nav_4_4" checked>
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_4">
          Рекомендации для iOS
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Рекомендации для iOS" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_4">
          <span class="md-nav__icon md-icon"></span>
          Рекомендации для iOS
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_4_1" data-md-state="indeterminate" type="checkbox" id="__nav_4_4_1" checked>
      
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_4_1">
          Хранение ключей/сертификатов
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Хранение ключей/сертификатов" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_4_1">
          <span class="md-nav__icon md-icon"></span>
          Хранение ключей/сертификатов
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ios/storing_a_key_certificate_in_the_directory_resources_of_the_application_ios/" class="md-nav__link">
        Хранение сертификата/ключа в директории/ресурсах приложения
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ios/storing_a_private_key_certificate_protected_by_a_password_in_the_directory_resources_of_the_application_ios/" class="md-nav__link">
        Хранение приватного ключа/сертификата защищенного паролем в директории/ресурсах приложения
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ios/storing_a_public_key_certificate_in_the_directory_resources_of_the_application_ios/" class="md-nav__link">
        Хранение публичного ключа/сертификата в директории/ресурсах приложения
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ios/storing_a_private_key_certificate_that_is_not_protected_by_a_password_in_the_directory_resources_of_the_application_ios/" class="md-nav__link">
        Хранение приватного ключа/сертификата не защищенного паролем в директории/ресурсах приложения
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_4_2" data-md-state="indeterminate" type="checkbox" id="__nav_4_4_2" checked>
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_4_2">
          Небезопасное хранение ключевой информации
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Небезопасное хранение ключевой информации" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_4_2">
          <span class="md-nav__icon md-icon"></span>
          Небезопасное хранение ключевой информации
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ios/a_writable_keystore_ios/" class="md-nav__link">
        Доступное на запись хранилище ключей
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ios/a_keystore_with_write_permission_protected_by_a_weak_password_ios/" class="md-nav__link">
        Доступное на запись хранилище ключей со слабым паролем
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ios/readable_file_keystore_ios/" class="md-nav__link">
        Доступное на чтение файловое хранилище ключей
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ios/a_readable_keystore%2C_protected_by_a_weak_password%2C_with_private_keys_ios/" class="md-nav__link">
        Доступное на чтение хранилище ключей со слабым паролем, содержащее закрытые ключи
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ios/a_readable_keystore%2C_protected_by_a_weak_password%2C_with_public_keys_ios/" class="md-nav__link">
        Доступное на чтение хранилище ключей со слабым паролем, содержащее открытые ключи
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ios/a_readable_keystore_containing_private_keys_protected_by_a_weak_password_ios/" class="md-nav__link">
        Доступное на чтение хранилище ключей с приватными ключами, защищёнными слабым паролем
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ios/using_a_file_keystore_ios/" class="md-nav__link">
        Использование файлового хранилища ключей
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ios/a_keystore%2C_protected_by_weak_password%2C_containing_private_keys_ios/" class="md-nav__link">
        Хранилище ключей со слабым паролем, содержащее закрытые ключи
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ios/a_keystore%2C_protected_by_weak_password%2C_containing_public_keys_ios/" class="md-nav__link">
        Хранилище ключей со слабым паролем, содержащее открытые ключи
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ios/a_keystore_containing_private_keys_protected_by_a_weak_password_ios/" class="md-nav__link">
        Хранилище ключей с приватными ключами, защищёнными слабым паролем
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ios/enabled_caching_of_network_requests_ios/" class="md-nav__link">
        Включенное кэширование сетевых запросов
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ios/output_of_sensitive_information_into_the_system_log_ios/" class="md-nav__link">
        Вывод sensitive-информации в системный лог
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ios/insecure_app_transport_security_configuration_ios/" class="md-nav__link">
        Небезопасная конфигурация App Transport Security
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ios/application_does_not_use_overflow_protection_features_ios/" class="md-nav__link">
        Приложение не использует функции защиты от переполнений
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ios/presence_of_build_scripts_in_the_built_application_package_ios/" class="md-nav__link">
        Наличие скриптов сборки в собранном пакете приложения
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ios/presence_of_podfile_in_the_built_application_package_ios/" class="md-nav__link">
        Наличие файла со списком сторонних зависимостей в собранном пакете приложения
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ios/storing_sensitive_information_in_the_keyboard_cache_ios/" class="md-nav__link">
        Хранение sensitive-информации в кэше клавиатуры
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ios/storing_sensitive_information_in_nsuserdefaults_ios/" class="md-nav__link">
        Хранение sensitive-информации в NSUserDefaults
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ios/storing_sensitive_information_in_a_private_file_ios/" class="md-nav__link">
        Хранение sensitive-информации в приватном файле
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ios/storing_sensitive_information_in_the_application_source_code_ios/" class="md-nav__link">
        Хранение sensitive-информации в исходном коде приложения
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ios/storing_sensitive_information_in_binary_cookies_ios/" class="md-nav__link">
        Хранение чувствительной информации в Binary Cookies
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ios/storage_or_use_of_previously_found_sensitive_information_ios/" class="md-nav__link">
        Хранение или использование ранее найденной чувствительной информации
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../faq/" class="md-nav__link">
        FAQ
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Содержание раздела">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Содержание раздела
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    Общие понятия
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    Слабый или устаревший алгоритм шифрования
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    Простой вектор инициализации
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    Слабый ключ шифрования
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    Неверные параметры для алгоритма генерации ключа
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    Использован уязвимый алгоритм хеширования
  </a>
  
    <nav class="md-nav" aria-label="Использован уязвимый алгоритм хеширования">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    Использование слова в качестве соли
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    Использование соли с низкой энтропией
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    Ссылки
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
<a href="https://github.com/sf-docs/stingraydocs/edit/master/docs/rg/ru/general/using of cryptographic algorithms.md" title="Редактировать страницу" class="md-content__button md-icon">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
</a>



<h1 id="_1">Небезопасное использование криптографических алгоритмов</h1>
<p>В ходе развития программных и аппаратных средств, а также в связи с новыми исследованиями в теории чисел и научной криптографии существующие решения и подходы шифрования данных могут устаревать. При выборе того или иного решения для шифрования данных следует всегда убеждаться, что выбранный алгоритм (трансформация) не устарел и на него нет успешных криптографических атак. Если же выбирается целое программное решение (библиотека, фреймворк, API), следует убедиться, что оно само не содержит ошибок или уязвимостей и также использует актуальные подходы к шифрованию.</p>
<h2 id="_2">Общие понятия</h2>
<p>Чтобы лучше понимать описанное далее, рекомендуется ознакомиться с основными понятиями и определениями из мира криптографии. Не будем глубоко погружаться в математику и сложные вычисление, но остановимся на базовых вещах, которые помогут лучше понять подсвеченные инструментом проблемы.</p>
<p><strong>Шифр</strong> — совокупность заранее оговоренных способов преобразования исходного секретного сообщения с целью его защиты.</p>
<p><strong>Сообщение (открытый текст)</strong>, полученное после преобразования с использованием любого шифра, называется <strong>шифрованным сообщением</strong> (закрытым текстом, криптограммой). В иностранной литературе закрытый текст и исходное сообщение называют <strong>ciphertext</strong> и <strong>plaintext</strong> соответственно.</p>
<p><strong>Ключ</strong> — информация, необходимая для шифрования и расшифровки сообщений.</p>
<p><span style='color: black; background: lightgreen'><strong>Соль</strong> — случайный набор данных, добавляемый к сообщению при хешировании для усложнения обратного преобразования (поиска исходных данных по известному результату хеширования).</p>
<p><strong>Криптостойкостью</strong> называется характеристика шифра, определяющая его стойкость к дешифрованию без знания ключа.</p>
<p>Шифрование бывает симметричное и асимметричное. В симметричном (для шифрования и расшифровки используется один и тот же ключ) основной проблемой является безопасная передача данного значения между сторонами. Поэтому, как правило, его применяют, если шифровать/расшифровывать данные необходимо только на устройстве и никуда их передавать не нужно.</p>
<figure>
<p><img alt="" src="../img/summ.png" /><figcaption>Симметричное шифрование</figcaption></p>
</figure>
<p>При асимметричном шифровании используются два ключа, которые называются публичный (public key) и приватный (private key). Эти ключи математически связаны друг с другом и их пара уникальна. На публичном ключе происходит шифрование данных, а приватным — расшифровка. Данный алгоритм используют чаще, если есть необходимость передавать данные куда-либо вне устройства.</p>
<figure>
<p><img alt="" src="../img/asumm.png" /><figcaption>Асимметричное шифрование</figcaption></p>
</figure>
<p>Помимо различия в ключах, алгоритмы шифрования бывают блочные и поточные. Поточные шифры в рамках данной уязвимости не рассматриваются. Особенность блочных шифров в том, что они работают с блоками строго определенной длины. То есть, если входная информация по размеру больше, чем умеет обрабатывать тот или иной алгоритм, то она будет разделена на блоки, каждый из которых будет зашифрован.</p>
<figure>
<p><img alt="" src="../img/example.png" /><figcaption>Классический пример блочного шифрования</figcaption></p>
</figure>
<p>Далее, в каждом из следующих блоков будет приведено описание недостатков, которые могут возникнуть при реализации шифрования, и способы эти недостатки устранить.</p>
<h2 id="_3">Слабый или устаревший алгоритм шифрования</h2>
<div class="admonition warning">
<p class="admonition-title">Важное замечание</p>
<p>Следует отметить, что приведенные ниже списки и оценки не являются точными с научной точки зрения. Дело в том, что безопасность многих перечисленных ниже алгоритмов может быть существенно повышена выбором соответствующих настроек или режимов, а также часто зависит от контекста использования самого алгоритма. Тем не менее в общем случае следует избегать использования таких алгоритмов, если вы не уверены в том, что делаете.</p>
</div>
<p>В настоящее время небезопасными, устаревшими и ненадежными считаются следующие алгоритмы:</p>
<ul>
<li>DES и его варианты (3DES, DESed, 2TDEA) с любыми настройками.</li>
<li>IDEA.</li>
<li>Blowfish — при шифровании больших (более 4 Гб) объемов данных.</li>
<li>AES в режиме ECB (трансформация AES/ECB) — режим ECB является самым небезопасным режимом блочного шифрования, в этом режиме все блоки шифруются независимо друг от друга одним и тем же ключом, что оставляет статистику исходного сообщения, а также позволяет провести атаку подменой блоков и некоторые другие виды атак. Для AES предпочтительно выбирать трансформацию AES/GCM — режим GCM работает достаточно быстро и, кроме того, добавляет аутентификацию к шифруемому сообщению, что не позволяет злоумышленнику внести изменения в результат шифрования.</li>
<li>AES в режиме CBC (AES/CBC…) — для режима CBC известна атака «padding oracle». В режиме CBC блок данных шифруется, а затем выполняется XOR между результатом шифрования и следующим блоком данных. Последний блок данных дополняется по тем или иным правилам (например заполняется байтами, каждый из которых равен числу дополненных байт). Суть атаки состоит в том, что имея «на руках» шифротекст и возможность получать ответ «Оракула» о том, правильное ли дополнение использовано или нет, злоумышленник получает возможность расшифровать все сообщение, кроме первого блока (при неизвестном векторе инициализации), а при известном — целиком. Атака осуществима, когда у злоумышленника есть возможность получать ответ «Оракула», например при клиент-серверном взаимодействии «Оракулом» может выступать сервер, возвращающий ответ 200 или 400 в случае правильного или неправильного дополнения.</li>
<li>RSA с ключом менее 2048 бит (лучше использовать 3072).</li>
<li>DSA с ключом менее 2048 бит (лучше использовать 3072).</li>
</ul>
<p>Стандартным и наиболее распространенным способом шифрования данных является использование алгоритма «AES/GCM» либо «AES/CBC».</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><a href="#__codelineno-0-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">encrypt</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">message</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">NoSuchAlgorithmException</span><span class="p">,</span><span class="w"></span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><a href="#__codelineno-0-2"><span class="linenos" data-linenos=" 2 "></span></a><span class="w">            </span><span class="n">NoSuchPaddingException</span><span class="p">,</span><span class="w"> </span><span class="n">IllegalBlockSizeException</span><span class="p">,</span><span class="w"></span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><a href="#__codelineno-0-3"><span class="linenos" data-linenos=" 3 "></span></a><span class="w">            </span><span class="n">BadPaddingException</span><span class="p">,</span><span class="w"> </span><span class="n">InvalidKeyException</span><span class="p">,</span><span class="w"></span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><a href="#__codelineno-0-4"><span class="linenos" data-linenos=" 4 "></span></a><span class="w">            </span><span class="n">UnsupportedEncodingException</span><span class="p">,</span><span class="w"> </span><span class="n">InvalidAlgorithmParameterException</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><a href="#__codelineno-0-5"><span class="linenos" data-linenos=" 5 "></span></a>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><a href="#__codelineno-0-6"><span class="linenos" data-linenos=" 6 "></span></a><span class="w">        </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">srcBuff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">message</span><span class="p">.</span><span class="na">getBytes</span><span class="p">(</span><span class="s">&quot;UTF8&quot;</span><span class="p">);</span><span class="w"></span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><a href="#__codelineno-0-7"><span class="linenos" data-linenos=" 7 "></span></a>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><a href="#__codelineno-0-8"><span class="linenos" data-linenos=" 8 "></span></a><span class="w">        </span><span class="n">SecretKeySpec</span><span class="w"> </span><span class="n">skeySpec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SecretKeySpec</span><span class="p">(</span><span class="n">KEY</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;AES&quot;</span><span class="p">);</span><span class="w"></span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><a href="#__codelineno-0-9"><span class="linenos" data-linenos=" 9 "></span></a><span class="w">        </span><span class="n">IvParameterSpec</span><span class="w"> </span><span class="n">ivSpec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IvParameterSpec</span><span class="p">(</span><span class="n">ivx</span><span class="p">);</span><span class="w"></span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><a href="#__codelineno-0-10"><span class="linenos" data-linenos="10 "></span></a><span class="w">        </span><span class="n">Cipher</span><span class="w"> </span><span class="n">ecipher</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Cipher</span><span class="p">.</span><span class="na">getInstance</span><span class="p">(</span><span class="s">&quot;AES/CBC/PKCS7Padding&quot;</span><span class="p">);</span><span class="w"></span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><a href="#__codelineno-0-11"><span class="linenos" data-linenos="11 "></span></a><span class="w">        </span><span class="n">ecipher</span><span class="p">.</span><span class="na">init</span><span class="p">(</span><span class="n">Cipher</span><span class="p">.</span><span class="na">ENCRYPT_MODE</span><span class="p">,</span><span class="w"> </span><span class="n">skeySpec</span><span class="p">,</span><span class="w"> </span><span class="n">ivSpec</span><span class="p">);</span><span class="w"></span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><a href="#__codelineno-0-12"><span class="linenos" data-linenos="12 "></span></a>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><a href="#__codelineno-0-13"><span class="linenos" data-linenos="13 "></span></a><span class="w">        </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">dstBuff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ecipher</span><span class="p">.</span><span class="na">doFinal</span><span class="p">(</span><span class="n">srcBuff</span><span class="p">);</span><span class="w"></span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><a href="#__codelineno-0-14"><span class="linenos" data-linenos="14 "></span></a>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><a href="#__codelineno-0-15"><span class="linenos" data-linenos="15 "></span></a><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">base64</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Base64</span><span class="p">.</span><span class="na">encodeToString</span><span class="p">(</span><span class="n">dstBuff</span><span class="p">,</span><span class="w"> </span><span class="n">Base64</span><span class="p">.</span><span class="na">DEFAULT</span><span class="p">);</span><span class="w"></span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><a href="#__codelineno-0-16"><span class="linenos" data-linenos="16 "></span></a>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><a href="#__codelineno-0-17"><span class="linenos" data-linenos="17 "></span></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">base64</span><span class="p">;</span><span class="w"></span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><a href="#__codelineno-0-18"><span class="linenos" data-linenos="18 "></span></a>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><a href="#__codelineno-0-19"><span class="linenos" data-linenos="19 "></span></a><span class="w">    </span><span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>Другой распространенной проблемой является использование алгоритма AES без указания режима сцепления блоков, так как по умолчанию используется режим ECB (Electronic Code Book — электронная кодовая книга). При данном режиме каждый блок шифруется отдельно и они никак не связаны друг с другом, что может упростить дешифровку сообщения. При случайном совпадении двух блоков на выходе получится одинаковый шифротекст, что даст возможность облегчить подбор ключа шифрования.</p>
<figure>
<p><img alt="" src="../img/ecb.png" /><figcaption>Режим сцепления блоков ECB</figcaption></p>
</figure>
<p>В случае же использования любого другого метода сцепления блоков появляется зависимость блоков друг от друга. Таким образом, расшифровать сообщение можно только целиком и даже два абсолютно одинаковых блока будут иметь разный шифротекст на выходе. Как пример можно рассмотреть режим CBC (Cipher Block Chaining — сцепление блоков).</p>
<figure>
<p><img alt="" src="../img/cbc.png" /><figcaption>Режим сцепления блоков CBC</figcaption></p>
</figure>
<h2 id="_4">Простой вектор инициализации</h2>
<p><strong>Initialization vector (IV)</strong> — произвольное число для предотвращения повторения шифрования данных в первом блоке. Может быть использовано вместе с ключом для шифрования данных.</p>
<p>Использование пустого или предсказуемого вектора инициализации является недопустимым в операциях шифрования. Для его генерации рекомендуется использовать класс <code>SecureRandom</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a><a href="#__codelineno-1-1"><span class="linenos" data-linenos="1 "></span></a><span class="n">val</span><span class="w"> </span><span class="n">iv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ByteArray</span><span class="p">(</span><span class="n">ivLength</span><span class="p">)</span><span class="w"></span>
<a id="__codelineno-1-2" name="__codelineno-1-2"></a><a href="#__codelineno-1-2"><span class="linenos" data-linenos="2 "></span></a><span class="n">SecureRandom</span><span class="p">().</span><span class="na">nextBytes</span><span class="p">(</span><span class="n">iv</span><span class="p">)</span><span class="w"></span>
</code></pre></div>
<p><code>ivLength</code> (то есть длина вектора инициализации) зависит от режима работы. И для большинства режимов, включая CBC, IV должен иметь ту же длину, что и блок. Алгоритм AES использует 128-битные блоки, поэтому длина вектора инициализации равна 128 битам (<code>ivLength</code> = 16 байт).</p>
<p>После генерации вектора инициализации достаточно создать экземпляр Cipher с его помощью:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1"></a><a href="#__codelineno-2-1"><span class="linenos" data-linenos="1 "></span></a><span class="n">cipher</span><span class="p">.</span><span class="na">init</span><span class="p">(</span><span class="n">Cipher</span><span class="p">.</span><span class="na">ENCRYPT_MODE</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">IvParameterSpec</span><span class="p">(</span><span class="n">iv</span><span class="p">))</span><span class="w"></span>
<a id="__codelineno-2-2" name="__codelineno-2-2"></a><a href="#__codelineno-2-2"><span class="linenos" data-linenos="2 "></span></a><span class="n">cipher</span><span class="p">.</span><span class="na">init</span><span class="p">(</span><span class="n">Cipher</span><span class="p">.</span><span class="na">DECRYPT_MODE</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">IvParameterSpec</span><span class="p">(</span><span class="n">iv</span><span class="p">))</span><span class="w"></span>
</code></pre></div>
<h2 id="_5">Слабый ключ шифрования</h2>
<p>Одним из основных параметров в шифровании является ключ шифрования. В целом от него зависит, насколько стойким в итоге будет шифротекст. И к его выбору стоит подойти наиболее ответственно. Одними из самых распространенных проблем являются использование предсказуемого или слишком короткого ключа шифрования, а также использование каких-либо данных пользователя в прямом виде (без процедуры расширения ключа). </p>
<p>Отдельной темой является дальнейшее хранение данного ключа, поэтому надежнее всего использовать встроенные механизмы системы для генерации ключей шифрования (Android KeyStore). При этом все задачи по хранению и генерации ключей система берет на себя.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1"></a><a href="#__codelineno-3-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="kd">final</span><span class="w"> </span><span class="n">KeyGenerator</span><span class="w"> </span><span class="n">keyGenerator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">KeyGenerator</span><span class="w"></span>
<a id="__codelineno-3-2" name="__codelineno-3-2"></a><a href="#__codelineno-3-2"><span class="linenos" data-linenos=" 2 "></span></a><span class="w">        </span><span class="p">.</span><span class="na">getInstance</span><span class="p">(</span><span class="n">KeyProperties</span><span class="p">.</span><span class="na">KEY_ALGORITHM_AES</span><span class="p">,</span><span class="w"> </span><span class="n">ANDROID_KEY_STORE</span><span class="p">);</span><span class="w"></span>
<a id="__codelineno-3-3" name="__codelineno-3-3"></a><a href="#__codelineno-3-3"><span class="linenos" data-linenos=" 3 "></span></a>
<a id="__codelineno-3-4" name="__codelineno-3-4"></a><a href="#__codelineno-3-4"><span class="linenos" data-linenos=" 4 "></span></a><span class="kd">final</span><span class="w"> </span><span class="n">KeyGenParameterSpec</span><span class="w"> </span><span class="n">keyGenParameterSpec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">KeyGenParameterSpec</span><span class="p">.</span><span class="na">Builder</span><span class="p">(</span><span class="n">alias</span><span class="p">,</span><span class="w"></span>
<a id="__codelineno-3-5" name="__codelineno-3-5"></a><a href="#__codelineno-3-5"><span class="linenos" data-linenos=" 5 "></span></a><span class="w">        </span><span class="n">KeyProperties</span><span class="p">.</span><span class="na">PURPOSE_ENCRYPT</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">KeyProperties</span><span class="p">.</span><span class="na">PURPOSE_DECRYPT</span><span class="p">)</span><span class="w"></span>
<a id="__codelineno-3-6" name="__codelineno-3-6"></a><a href="#__codelineno-3-6"><span class="linenos" data-linenos=" 6 "></span></a><span class="w">        </span><span class="p">.</span><span class="na">setBlockModes</span><span class="p">(</span><span class="n">KeyProperties</span><span class="p">.</span><span class="na">BLOCK_MODE_GCM</span><span class="p">)</span><span class="w"></span>
<a id="__codelineno-3-7" name="__codelineno-3-7"></a><a href="#__codelineno-3-7"><span class="linenos" data-linenos=" 7 "></span></a><span class="w">        </span><span class="p">.</span><span class="na">setEncryptionPaddings</span><span class="p">(</span><span class="n">KeyProperties</span><span class="p">.</span><span class="na">ENCRYPTION_PADDING_NONE</span><span class="p">)</span><span class="w"></span>
<a id="__codelineno-3-8" name="__codelineno-3-8"></a><a href="#__codelineno-3-8"><span class="linenos" data-linenos=" 8 "></span></a><span class="w">        </span><span class="p">.</span><span class="na">build</span><span class="p">();</span><span class="w"></span>
<a id="__codelineno-3-9" name="__codelineno-3-9"></a><a href="#__codelineno-3-9"><span class="linenos" data-linenos=" 9 "></span></a>
<a id="__codelineno-3-10" name="__codelineno-3-10"></a><a href="#__codelineno-3-10"><span class="linenos" data-linenos="10 "></span></a><span class="n">keyGenerator</span><span class="p">.</span><span class="na">init</span><span class="p">(</span><span class="n">keyGenParameterSpec</span><span class="p">);</span><span class="w"></span>
<a id="__codelineno-3-11" name="__codelineno-3-11"></a><a href="#__codelineno-3-11"><span class="linenos" data-linenos="11 "></span></a><span class="kd">final</span><span class="w"> </span><span class="n">SecretKey</span><span class="w"> </span><span class="n">secretKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">keyGenerator</span><span class="p">.</span><span class="na">generateKey</span><span class="p">();</span><span class="w"></span>
<a id="__codelineno-3-12" name="__codelineno-3-12"></a><a href="#__codelineno-3-12"><span class="linenos" data-linenos="12 "></span></a>
<a id="__codelineno-3-13" name="__codelineno-3-13"></a><a href="#__codelineno-3-13"><span class="linenos" data-linenos="13 "></span></a><span class="kd">final</span><span class="w"> </span><span class="n">Cipher</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Cipher</span><span class="p">.</span><span class="na">getInstance</span><span class="p">(</span><span class="n">TRANSFORMATION</span><span class="p">);</span><span class="w"></span>
<a id="__codelineno-3-14" name="__codelineno-3-14"></a><a href="#__codelineno-3-14"><span class="linenos" data-linenos="14 "></span></a><span class="n">cipher</span><span class="p">.</span><span class="na">init</span><span class="p">(</span><span class="n">Cipher</span><span class="p">.</span><span class="na">ENCRYPT_MODE</span><span class="p">,</span><span class="w"> </span><span class="n">secretKey</span><span class="p">);</span><span class="w"></span>
<a id="__codelineno-3-15" name="__codelineno-3-15"></a><a href="#__codelineno-3-15"><span class="linenos" data-linenos="15 "></span></a>
<a id="__codelineno-3-16" name="__codelineno-3-16"></a><a href="#__codelineno-3-16"><span class="linenos" data-linenos="16 "></span></a><span class="n">iv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cipher</span><span class="p">.</span><span class="na">getIV</span><span class="p">();</span><span class="w"></span>
<a id="__codelineno-3-17" name="__codelineno-3-17"></a><a href="#__codelineno-3-17"><span class="linenos" data-linenos="17 "></span></a>
<a id="__codelineno-3-18" name="__codelineno-3-18"></a><a href="#__codelineno-3-18"><span class="linenos" data-linenos="18 "></span></a><span class="n">encryption</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cipher</span><span class="p">.</span><span class="na">doFinal</span><span class="p">(</span><span class="n">textToEncrypt</span><span class="p">.</span><span class="na">getBytes</span><span class="p">(</span><span class="s">&quot;UTF-8&quot;</span><span class="p">));</span><span class="w"></span>
</code></pre></div>
<h2 id="_6">Неверные параметры для алгоритма генерации ключа</h2>
<p>Использование любых данных пользователя в качестве ключа шифрования — это достаточно распространенная, но очень плохая практика. Как правило, таким значениям недостает длины или случайности, поэтому специально для таких случаев предусмотрели процедуру получения ключа шифрования из данных пользователя и называется она «Процедура расширения ключа» или «Функция определения ключа на основе пароля». Рассмотрим мы ее на примере одной из функций под названием PBKDF2 (Password-Based Key Derivation Function):</p>
<ul>
<li>PBKDF2 выполняет функцию усиления в несколько итераций для получения ключа. Обычно это около 10 тысяч итераций.</li>
<li>Рост количества итераций увеличивает время, необходимое для успешной атаки с использованием полного перебора (brute force).</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1"></a><a href="#__codelineno-4-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="cm">/**</span>
<a id="__codelineno-4-2" name="__codelineno-4-2"></a><a href="#__codelineno-4-2"><span class="linenos" data-linenos=" 2 "></span></a><span class="cm">* Creates a hash in base64 of the user&#39;s password using pbkdf2 since we have no nice alternatives like bcrypt.</span>
<a id="__codelineno-4-3" name="__codelineno-4-3"></a><a href="#__codelineno-4-3"><span class="linenos" data-linenos=" 3 "></span></a><span class="cm">* @param password user&#39;s password</span>
<a id="__codelineno-4-4" name="__codelineno-4-4"></a><a href="#__codelineno-4-4"><span class="linenos" data-linenos=" 4 "></span></a><span class="cm">* @return a bas64 representation of the pbkdf2 hash</span>
<a id="__codelineno-4-5" name="__codelineno-4-5"></a><a href="#__codelineno-4-5"><span class="linenos" data-linenos=" 5 "></span></a><span class="cm">* @throws GeneralSecurityException</span>
<a id="__codelineno-4-6" name="__codelineno-4-6"></a><a href="#__codelineno-4-6"><span class="linenos" data-linenos=" 6 "></span></a><span class="cm">*/</span><span class="w"></span>
<a id="__codelineno-4-7" name="__codelineno-4-7"></a><a href="#__codelineno-4-7"><span class="linenos" data-linenos=" 7 "></span></a><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">generateUserHash</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">password</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">GeneralSecurityException</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<a id="__codelineno-4-8" name="__codelineno-4-8"></a><a href="#__codelineno-4-8"><span class="linenos" data-linenos=" 8 "></span></a><span class="w">    </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">salt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">byte</span><span class="o">[</span><span class="n">HASH_SALT_SIZE</span><span class="o">]</span><span class="p">;</span><span class="w"></span>
<a id="__codelineno-4-9" name="__codelineno-4-9"></a><a href="#__codelineno-4-9"><span class="linenos" data-linenos=" 9 "></span></a><span class="w">    </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">SecureRandom</span><span class="p">()).</span><span class="na">nextBytes</span><span class="p">(</span><span class="n">salt</span><span class="p">);</span><span class="w"></span>
<a id="__codelineno-4-10" name="__codelineno-4-10"></a><a href="#__codelineno-4-10"><span class="linenos" data-linenos="10 "></span></a>
<a id="__codelineno-4-11" name="__codelineno-4-11"></a><a href="#__codelineno-4-11"><span class="linenos" data-linenos="11 "></span></a><span class="w">    </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">hash</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">generateUserHash</span><span class="p">(</span><span class="n">password</span><span class="p">,</span><span class="w"> </span><span class="n">salt</span><span class="p">);</span><span class="w"></span>
<a id="__codelineno-4-12" name="__codelineno-4-12"></a><a href="#__codelineno-4-12"><span class="linenos" data-linenos="12 "></span></a>
<a id="__codelineno-4-13" name="__codelineno-4-13"></a><a href="#__codelineno-4-13"><span class="linenos" data-linenos="13 "></span></a><span class="w">    </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">byte</span><span class="o">[</span><span class="n">HASH_SALT_SIZE</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">HASH_OUTPUT_SIZE</span><span class="o">]</span><span class="p">;</span><span class="w"></span>
<a id="__codelineno-4-14" name="__codelineno-4-14"></a><a href="#__codelineno-4-14"><span class="linenos" data-linenos="14 "></span></a>
<a id="__codelineno-4-15" name="__codelineno-4-15"></a><a href="#__codelineno-4-15"><span class="linenos" data-linenos="15 "></span></a><span class="w">    </span><span class="n">System</span><span class="p">.</span><span class="na">arraycopy</span><span class="p">(</span><span class="n">salt</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">salt</span><span class="p">.</span><span class="na">length</span><span class="p">);</span><span class="w"></span>
<a id="__codelineno-4-16" name="__codelineno-4-16"></a><a href="#__codelineno-4-16"><span class="linenos" data-linenos="16 "></span></a><span class="w">    </span><span class="n">System</span><span class="p">.</span><span class="na">arraycopy</span><span class="p">(</span><span class="n">hash</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">salt</span><span class="p">.</span><span class="na">length</span><span class="p">,</span><span class="w"> </span><span class="n">HASH_OUTPUT_SIZE</span><span class="p">);</span><span class="w"></span>
<a id="__codelineno-4-17" name="__codelineno-4-17"></a><a href="#__codelineno-4-17"><span class="linenos" data-linenos="17 "></span></a>
<a id="__codelineno-4-18" name="__codelineno-4-18"></a><a href="#__codelineno-4-18"><span class="linenos" data-linenos="18 "></span></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Base64</span><span class="p">.</span><span class="na">encodeToString</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">Base64</span><span class="p">.</span><span class="na">DEFAULT</span><span class="p">);</span><span class="w"></span>
<a id="__codelineno-4-19" name="__codelineno-4-19"></a><a href="#__codelineno-4-19"><span class="linenos" data-linenos="19 "></span></a><span class="p">}</span><span class="w"></span>
<a id="__codelineno-4-20" name="__codelineno-4-20"></a><a href="#__codelineno-4-20"><span class="linenos" data-linenos="20 "></span></a>
<a id="__codelineno-4-21" name="__codelineno-4-21"></a><a href="#__codelineno-4-21"><span class="linenos" data-linenos="21 "></span></a><span class="cm">/**</span>
<a id="__codelineno-4-22" name="__codelineno-4-22"></a><a href="#__codelineno-4-22"><span class="linenos" data-linenos="22 "></span></a><span class="cm">* Creates a hash in bytes of the user&#39;s password.</span>
<a id="__codelineno-4-23" name="__codelineno-4-23"></a><a href="#__codelineno-4-23"><span class="linenos" data-linenos="23 "></span></a><span class="cm">* @param password the user&#39;s password</span>
<a id="__codelineno-4-24" name="__codelineno-4-24"></a><a href="#__codelineno-4-24"><span class="linenos" data-linenos="24 "></span></a><span class="cm">* @param salt the salt to use when creating the hash</span>
<a id="__codelineno-4-25" name="__codelineno-4-25"></a><a href="#__codelineno-4-25"><span class="linenos" data-linenos="25 "></span></a><span class="cm">* @return the pbkdf2 hash of the user&#39;s password in bytes</span>
<a id="__codelineno-4-26" name="__codelineno-4-26"></a><a href="#__codelineno-4-26"><span class="linenos" data-linenos="26 "></span></a><span class="cm">* @throws GeneralSecurityException</span>
<a id="__codelineno-4-27" name="__codelineno-4-27"></a><a href="#__codelineno-4-27"><span class="linenos" data-linenos="27 "></span></a><span class="cm">*/</span><span class="w"></span>
<a id="__codelineno-4-28" name="__codelineno-4-28"></a><a href="#__codelineno-4-28"><span class="linenos" data-linenos="28 "></span></a><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="nf">generateUserHash</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">password</span><span class="p">,</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">salt</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">GeneralSecurityException</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<a id="__codelineno-4-29" name="__codelineno-4-29"></a><a href="#__codelineno-4-29"><span class="linenos" data-linenos="29 "></span></a><span class="cm">/*</span>
<a id="__codelineno-4-30" name="__codelineno-4-30"></a><a href="#__codelineno-4-30"><span class="linenos" data-linenos="30 "></span></a><span class="cm">https://security.stackexchange.com/a/47188/79148</span>
<a id="__codelineno-4-31" name="__codelineno-4-31"></a><a href="#__codelineno-4-31"><span class="linenos" data-linenos="31 "></span></a><span class="cm">We use PBKDF2 because android doesn&#39;t natively support bcrypt, scrypt, or argon2i.</span>
<a id="__codelineno-4-32" name="__codelineno-4-32"></a><a href="#__codelineno-4-32"><span class="linenos" data-linenos="32 "></span></a><span class="cm">Additionally, keep in mind that this will only provide 20 bytes of security instead</span>
<a id="__codelineno-4-33" name="__codelineno-4-33"></a><a href="#__codelineno-4-33"><span class="linenos" data-linenos="33 "></span></a><span class="cm">of 32 bytes because we&#39;re using HmacSHA1. Android doesn&#39;t support HmacSHA256.</span>
<a id="__codelineno-4-34" name="__codelineno-4-34"></a><a href="#__codelineno-4-34"><span class="linenos" data-linenos="34 "></span></a><span class="cm">You can use SpongyCastle/BouncyCastle to include support for PBKDF2-HmacSHA256.</span>
<a id="__codelineno-4-35" name="__codelineno-4-35"></a><a href="#__codelineno-4-35"><span class="linenos" data-linenos="35 "></span></a><span class="cm">*/</span><span class="w"></span>
<a id="__codelineno-4-36" name="__codelineno-4-36"></a><a href="#__codelineno-4-36"><span class="linenos" data-linenos="36 "></span></a><span class="w">    </span><span class="n">SecretKeyFactory</span><span class="w"> </span><span class="n">factory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SecretKeyFactory</span><span class="p">.</span><span class="na">getInstance</span><span class="p">(</span><span class="s">&quot;PBKDF2WithHmacSHA1&quot;</span><span class="p">);</span><span class="w"></span>
<a id="__codelineno-4-37" name="__codelineno-4-37"></a><a href="#__codelineno-4-37"><span class="linenos" data-linenos="37 "></span></a><span class="w">    </span><span class="n">PBEKeySpec</span><span class="w"> </span><span class="n">keySpec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">PBEKeySpec</span><span class="p">(</span><span class="n">password</span><span class="p">.</span><span class="na">toCharArray</span><span class="p">(),</span><span class="w"> </span><span class="n">salt</span><span class="p">,</span><span class="w"> </span><span class="n">HASH_ITERATIONS</span><span class="p">,</span><span class="w"> </span><span class="n">HASH_OUTPUT_SIZE</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">8</span><span class="p">);</span><span class="w"></span>
<a id="__codelineno-4-38" name="__codelineno-4-38"></a><a href="#__codelineno-4-38"><span class="linenos" data-linenos="38 "></span></a><span class="w">    </span><span class="n">SecretKey</span><span class="w"> </span><span class="n">hash</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">factory</span><span class="p">.</span><span class="na">generateSecret</span><span class="p">(</span><span class="n">keySpec</span><span class="p">);</span><span class="w"></span>
<a id="__codelineno-4-39" name="__codelineno-4-39"></a><a href="#__codelineno-4-39"><span class="linenos" data-linenos="39 "></span></a>
<a id="__codelineno-4-40" name="__codelineno-4-40"></a><a href="#__codelineno-4-40"><span class="linenos" data-linenos="40 "></span></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">hash</span><span class="p">.</span><span class="na">getEncoded</span><span class="p">();</span><span class="w"></span>
<a id="__codelineno-4-41" name="__codelineno-4-41"></a><a href="#__codelineno-4-41"><span class="linenos" data-linenos="41 "></span></a><span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>В итоге мы получим достаточно адекватный ключ шифрования, удовлетворяющий всем необходимым параметрам (длина, случайность). И так как мы используем данные, которые вводит пользователь, можем не хранить этот ключ постоянно, а генерировать его налету каждый раз, когда нам необходимо зашифровать или расшифровать данные.</p>
<p>Чтобы обработать ситуацию, когда мы используем пароль пользователя в процедуре расширения ключа и шифрования данных, а пользователь внезапно решил сменить пароль, возможно применение алгоритма KEK&amp;DEK (Key Encryption Key &amp; Data Encryption Key). При таком подходе мы генерируем ключ шифрования для данных при помощи <code>SecureRandom</code>, шифруем на нем нужные нам данные, а после для безопасного хранения этого ключа используем процедуру расширения на основе пароля пользователя и получившимся ключом шифруем ключ шифрования данных. Схематично это выглядит следующим образом.</p>
<figure>
<p><img alt="" src="../img/2k.png" /><figcaption>Примерная схема с использованием двух ключей</figcaption></p>
</figure>
<p>При таком подходе мы сначала создаем ключ для шифрования данных (Data Encryption Key). Затем на нем зашифровываем данные и уже этот ключ шифруем при помощи нового ключа (Key Encryption Key). Как раз этот KEK можно либо сохранить в Keystore, либо генерировать каждый раз (например, на основе пароля пользователя). При таком механизме мы избавляемся от повторной зашифровки данных в случае изменения/компрометации ключа. Нам достаточно повторно зашифровать только DEK и не трогать данные (конечно, это не так, если у нас скомпрометирован DEK, но такой вариант маловероятен). В этом случае, каков бы ни был объем данных, которые нужно сохранить в секрете, время повторного шифрования всегда будет одинаковым, так как сами зашифрованные данные мы не трогаем. </p>
<h2 id="_7">Использован уязвимый алгоритм хеширования</h2>
<p><strong>Хэширование</strong> — особое преобразование любого объема информации, в результате которого получается некое значение (<strong>хэш</strong>) — уникальная короткая символьная строка, которая присуща только этому массиву входящей информации. </p>
<p>Приведем некоторые свойства хэш-функций, на основе которых выбирают правильный алгоритм хэширования:</p>
<ul>
<li>Детерминированность.</li>
<li>Скорость.</li>
<li>Сложность обратного вычисления.</li>
<li>Небольшие изменения во вводимых данных изменяют хэш.</li>
<li>Устойчивость к коллизиям.</li>
</ul>
<p>Основными врагами таких алгоритмов являются огромные базы данных уже посчитанных различных хэшей для очень большого количества разных строк. Есть целые сервисы, которые занимаются тем, что все время считают различные хэши от всех возможных комбинаций символов. Конечно, сначала им «скармливают» все базы паролей и утечек, они считают их, а потом пользовательские запросы. И уже после они занимаются подсчетом оставшихся значений. Принцип работы таких сервисов прост: вбиваешь интересующий тебя хэш, а в ответе видишь, есть ли он в базе и какое значение ему соответствует. И для большинства паролей, задаваемых пользователями, такие совпадения есть. Как пример — приложение, которое хранит пин пользователя, как простой <code>SHA-1(pin)</code>. И, конечно, первой же ссылкой в Google, если вбить туда значение этого хэша, будет пин-код пользователя. Другой проблемой являются коллизии, когда два абсолютно разных значения после преобразования дают одинаковый хэш. И алгоритмы хэширования, как правило, признают устаревшими как раз после того, как становится возможным за приемлемое время подобрать данные для успешной коллизии. Как хороший пример невозможности использования SHA-1 является данный <a href="https://github.com/nneonneo/sha1collider">репозиторий</a>. Он наглядно показывает, как два документа (оригинальный и измененный), могут получить одинаковое значение хэша.</p>
<p>Чтобы избежать подобных вещей, используйте соль при хэшировании. Это существенно повысит энтропию и позволит не беспокоиться хотя бы о базе посчитанных хэшей.</p>
<p>И конечно, стоит запомнить, что:</p>
<ul>
<li>MD5 не подходит для любых криптографических целей.</li>
<li>SHA1 не подходит для любых криптографических целей.</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Примечание</p>
<ul>
<li>При генерации случайных данных для любых целей криптографии (соль, вектор инициализации, ключ) следует использовать <code>SecureRandom</code>, а не обычный <code>Random</code>.</li>
<li>Также при создании вектора инициализации и соли не следует использовать тривиальные данные, например заполнять массив нулями или использовать другие значения с низкой энтропией.</li>
<li>При генерации ключа (PBE, PBKDF2) следует устанавливать количество итераций как можно большим, исходя из возможностей аппаратной части и требований безопасности. В системе «Стингрей» оценочно небезопасным считается значение менее 10 000 итераций.</li>
<li>Нельзя использовать пароль как ключ шифрования напрямую (то есть без использования алгоритмов генерации ключа)</li>
</ul>
</div>
<h3 id="_8"><span style='color: black; background: lightgreen'>Использование слова в качестве соли</h3>
<p><span style='color: black; background: lightgreen'>Иногда разработчики в качестве значения соли используют набор байт, являющийся словом или фразой естественного языка. Такая ошибка свидетельствует, что значение соли захардкожено (в коде или ресурсах приложения), а не вычисляется случайным образом.</p>
<h3 id="_9"><span style='color: black; background: lightgreen'>Использование соли с низкой энтропией</h3>
<p><span style='color: black; background: lightgreen'>Для хеширования взята соль, заполненная, скорее всего, не случайными данными, а например нулями [0, 0, 0, …] или другими повторяющимися данными.</p>
<h2 id="_10">Ссылки</h2>
<ol>
<li><a href="https://www.baeldung.com/java-encryption-iv">https://www.baeldung.com/java-encryption-iv</a> </li>
<li><a href="https://proandroiddev.com/secure-data-in-android-initialization-vector-6ca1c659762c">https://proandroiddev.com/secure-data-in-android-initialization-vector-6ca1c659762c</a> </li>
<li><a href="https://medium.com/beautycoder/android-security-and-fingerprint-ef0f6f344888">https://medium.com/beautycoder/android-security-and-fingerprint-ef0f6f344888</a> </li>
<li><a href="https://developer.android.com/training/articles/keystore">https://developer.android.com/training/articles/keystore</a> </li>
<li><a href="https://medium.com/@josiassena/using-the-android-keystore-system-to-store-sensitive-information-3a56175a454b">https://medium.com/@josiassena/using-the-android-keystore-system-to-store-sensitive-information-3a56175a454b</a> </li>
<li><a href="https://habr.com/ru/company/swordfish_security/blog/658433/">https://habr.com/ru/company/swordfish_security/blog/658433/</a> </li>
<li><a href="https://habr.com/ru/company/swordfish_security/blog/664720/">https://habr.com/ru/company/swordfish_security/blog/664720/</a></li>
<li><a href="https://github.com/d0nutptr/Android-Security-Examples/blob/master/Cryptography/app/src/main/java/com/iismathwizard/cryptonote/Crypto.java">https://github.com/d0nutptr/Android-Security-Examples/blob/master/Cryptography/app/src/main/java/com/iismathwizard/cryptonote/Crypto.java</a> </li>
<li><a href="https://github.com/flast101/padding-oracle-attack-explained/blob/master/oracle.py">https://github.com/flast101/padding-oracle-attack-explained/blob/master/oracle.py</a> </li>
<li><a href="https://habr.com/ru/post/247527/?ysclid=l9wqtx7li4787340116">https://habr.com/ru/post/247527/?ysclid=l9wqtx7li4787340116</a> </li>
<li><a href="https://en.wikipedia.org/wiki/Padding_oracle_attack">https://en.wikipedia.org/wiki/Padding_oracle_attack</a></li>
</ol>

              
            </article>
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" data-md-state="hidden">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg>
            К началу
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Нижний колонтитул">
      
        
        <a href="../../../" class="md-footer__link md-footer__link--prev" aria-label="Назад: Рекомендации по безопасной разработке приложений" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Назад
              </span>
              Рекомендации по безопасной разработке приложений
            </div>
          </div>
        </a>
      
      
        
        <a href="../../android/a_writable_keystore/" class="md-footer__link md-footer__link--next" aria-label="Вперед: Доступное на запись хранилище ключей" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Вперед
              </span>
              Доступное на запись хранилище ключей
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
  <div class="copy">
    <div class="logo_footer"><img src="../../assets/logo_footer.png" alt="" srcset=""></div>
    <p class="footer_info">Номер свидетельства о регистрации в Федеральной службе по интеллектуальной собственности: 2020660236.</p>
    <p class="footer_info">Регистрационный номер в реестре российского ПО Министерства Цифрового Развития РФ: 7699</p>
  </div>
  <p class="footer_info">© 2020—2022&nbsp;&nbsp;<a href="https://stingray-mobile.ru//" target="_blank" rel="noopener">ООО «Стингрей Технолоджиз»</a></p>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../../..", "features": ["navigation.instant", "navigation.tabs", "navigation.expand", "navigation.indexes", "navigation.top", "search.suggest", "search.highlight", "search.shares", "content.code.annotate", "content.tabs.link"], "search": "../../../../assets/javascripts/workers/search.d5a3c699.min.js", "translations": {"clipboard.copied": "\u0421\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u043e \u0432 \u0431\u0443\u0444\u0435\u0440", "clipboard.copy": "\u041a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0432 \u0431\u0443\u0444\u0435\u0440", "search.config.lang": "ru", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "\u041f\u043e\u0438\u0441\u043a", "search.result.more.one": "\u0415\u0449\u0451 1 \u043d\u0430 \u044d\u0442\u043e\u0439 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435", "search.result.more.other": "\u0415\u0449\u0451 # \u043d\u0430 \u044d\u0442\u043e\u0439 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435", "search.result.none": "\u0421\u043e\u0432\u043f\u0430\u0434\u0435\u043d\u0438\u0439 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e", "search.result.one": "\u041d\u0430\u0439\u0434\u0435\u043d\u043e 1 \u0441\u043e\u0432\u043f\u0430\u0434\u0435\u043d\u0438\u0435", "search.result.other": "\u041d\u0430\u0439\u0434\u0435\u043d\u043e \u0441\u043e\u0432\u043f\u0430\u0434\u0435\u043d\u0438\u0439: #", "search.result.placeholder": "\u041d\u0430\u0447\u043d\u0438\u0442\u0435 \u043f\u0435\u0447\u0430\u0442\u0430\u0442\u044c \u0434\u043b\u044f \u043f\u043e\u0438\u0441\u043a\u0430", "search.result.term.missing": "\u041e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442", "select.version.title": "\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0432\u0435\u0440\u0441\u0438\u044e"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.897f3768.min.js"></script>
      
    
  